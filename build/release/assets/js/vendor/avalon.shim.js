!function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("Avalon requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(w,e){var g=new Date-0,$=w.document,t=$.getElementsByTagName("head")[0],C=t.insertBefore(document.createElement("avalon"),t.firstChild);C.innerHTML="X<style id='avalonStyle'>.avalonHide{ display: none!important }</style>",C.setAttribute("ms-skip","1"),C.className="avalonHide";var n=/\[native code\]/;function y(){w.console&&avalon.config.debug&&Function.apply.call(console.log,console,arguments)}var b="$"+g,r=w.require,a=w.define,m=!1,h=/[^, ]+/g,d=/^(?:object|array)$/,T=/^\[object SVG\w*Element\]$/,i=/^\[object (?:Window|DOMWindow|global)\]$/,o=Object.prototype,c=o.hasOwnProperty,l=o.toString,v=Array.prototype,x=v.slice,s={},_=w.dispatchEvent,E=$.documentElement,A=$.createDocumentFragment(),p=$.createElement("div"),u={};function M(){}function f(e,t){"string"==typeof e&&(e=e.match(h)||[]);for(var n={},r=void 0!==t?t:1,a=0,i=e.length;a<i;a++)n[e[a]]=r;return n}"Boolean Number String Function Array Date RegExp Object Error".replace(h,function(e){u["[object "+e+"]"]=e.toLowerCase()});var k=function(e){return e=e||"avalon",String(Math.random()+Math.random()).replace(/\d\.\d{4}/,e)};var O=function(){if(w.VBArray){var e=document.documentMode;return e||(w.XMLHttpRequest?7:6)}return NaN}();avalon=function(e){return new avalon.init(e)},avalon.profile=function(){w.console&&avalon.config.profile&&Function.apply.call(console.log,console,arguments)},avalon.nextTick=new function(){var e=w.setImmediate,t=w.MutationObserver,n=_&&w.postMessage;if(e)return e.bind(w);var r=[];function a(){for(var e=r.length,t=0;t<e;t++)r[t]();r=r.slice(e)}if(t){var i=document.createTextNode("avalon");return new t(a).observe(i,{characterData:!0}),function(e){r.push(e),i.data=Math.random()}}return n?(w.addEventListener("message",function(e){var t=e.source;t!==w&&null!==t||"process-tick"!==e.data||(e.stopPropagation(),a())}),function(e){r.push(e),w.postMessage("process-tick","*")}):function(e){setTimeout(e,0)}},avalon.init=function(e){this[0]=this.element=e},avalon.fn=avalon.prototype=avalon.init.prototype,avalon.type=function(e){return null==e?String(e):"object"==typeof e||"function"==typeof e?u[l.call(e)]||"object":typeof e};var N,S="object"==typeof alert?function(e){try{return/^\s*\bfunction\b/.test(e+"")}catch(e){return!1}}:function(e){return"[object Function]"===l.call(e)};function L(e){return i.test(l.call(e))}for(N in avalon.isFunction=S,avalon.isWindow=function(e){return!!e&&(e==e.document&&e.document!=e)},L(w)&&(avalon.isWindow=L),avalon({}))break;var j="0"!==N;function H(e,t){return(e=Math.floor(e)||0)<0?Math.max(t+e,0):Math.min(e,t)}avalon.isPlainObject=function(e,t){if(!e||"object"!==avalon.type(e)||e.nodeType||avalon.isWindow(e))return!1;try{if(e.constructor&&!c.call(e,"constructor")&&!c.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}if(j)for(t in e)return c.call(e,t);for(t in e);return void 0===t||c.call(e,t)},n.test(Object.getPrototypeOf)&&(avalon.isPlainObject=function(e){return"[object Object]"===l.call(e)&&Object.getPrototypeOf(e)===o}),avalon.mix=avalon.fn.mix=function(){var e,t,n,r,a,i,o=arguments[0]||{},l=1,s=arguments.length,c=!1;for("boolean"==typeof o&&(c=o,o=arguments[1]||{},l++),"object"==typeof o||S(o)||(o={}),l===s&&(o=this,l--);l<s;l++)if(null!=(e=arguments[l]))for(t in e){n=o[t];try{r=e[t]}catch(e){continue}o!==r&&(c&&r&&(avalon.isPlainObject(r)||(a=Array.isArray(r)))?(i=a?(a=!1,n&&Array.isArray(n)?n:[]):n&&avalon.isPlainObject(n)?n:{},o[t]=avalon.mix(c,i,r)):void 0!==r&&(o[t]=r))}return o},avalon.mix({rword:h,subscribers:b,version:1.45,ui:{},log:y,slice:_?function(e,t,n){return x.call(e,t,n)}:function(e,t,n){var r=[],a=e.length;if(void 0===n&&(n=a),"number"==typeof n&&isFinite(n)){t=H(t,a),n=H(n,a);for(var i=t;i<n;++i)r[i-t]=e[i]}return r},noop:M,error:function(e,t){throw(t||Error)(e)},oneObject:f,range:function(e,t,n){n=n||1,null==t&&(t=e||0,e=0);for(var r=-1,a=Math.max(0,Math.ceil((t-e)/n)),i=new Array(a);++r<a;)i[r]=e,e+=n;return i},eventHooks:[],bind:function(t,e,n,r){var a=avalon.eventHooks[e];"object"==typeof a&&(e=a.type,a.deel&&(n=a.deel(t,e,n,r)));var i=_?n:function(e){n.call(t,function(e){var t={};for(var n in e)t[n]=e[n];var r=t.target=e.srcElement;if(0===e.type.indexOf("key"))t.which=null!=e.charCode?e.charCode:e.keyCode;else if(J.test(e.type)){var a=r.ownerDocument||$,i="BackCompat"===a.compatMode?a.body:a.documentElement;t.pageX=e.clientX+(i.scrollLeft>>0)-(i.clientLeft>>0),t.pageY=e.clientY+(i.scrollTop>>0)-(i.clientTop>>0),t.wheelDeltaY=t.wheelDelta,t.wheelDeltaX=0}return t.timeStamp=new Date-0,t.originalEvent=e,t.preventDefault=function(){e.returnValue=!1},t.stopPropagation=function(){e.cancelBubble=!0},t}(e))};return _?t.addEventListener(e,i,!!r):t.attachEvent("on"+e,i),i},unbind:function(e,t,n,r){var a=avalon.eventHooks[t],i=n||M;"object"==typeof a&&(t=a.type,a.deel&&(n=a.deel(e,t,n,!1))),_?e.removeEventListener(t,i,!!r):e.detachEvent("on"+t,i)},css:function(e,t,n){e instanceof avalon&&(e=e[0]);var r=/[_-]/.test(t)?lt(t):t;if(t=avalon.cssName(r)||r,void 0===n||"boolean"==typeof n){"background"===t&&(t="backgroundColor");var a=(mt[r+":get"]||mt["@:get"])(e,t);return!0===n?parseFloat(a)||0:a}if(""===n)e.style[t]="";else{if(null==n||n!=n)return;isFinite(n)&&!avalon.cssNumber[r]&&(n+="px"),(mt[r+":set"]||mt["@:set"])(e,t,n)}},each:function(e,t){if(e){var n=0;if(function(t){if(!t)return!1;var e=t.length;if(e===e>>>0){var n=l.call(t).slice(8,-1);if(/(?:regexp|string|function|window|global)$/i.test(n))return!1;if("Array"===n)return!0;try{return!1!=={}.propertyIsEnumerable.call(t,"length")||/^\s?function/.test(t.item||t.callee)}catch(e){return!t.window}}return!1}(e))for(var r=e.length;n<r&&!1!==t(n,e[n]);n++);else for(n in e)if(e.hasOwnProperty(n)&&!1===t(n,e[n]))break}},getWidgetData:function(e,t){var n=avalon(e).data(),r={};for(var a in n)0===a.indexOf(t)&&(r[a.replace(t,"").replace(/\w/,function(e){return e.toLowerCase()})]=n[a]);return r},Array:{ensure:function(e,t){if(-1===e.indexOf(t))return e.push(t)},removeAt:function(e,t){return!!e.splice(t,1).length},remove:function(e,t){var n=e.indexOf(t);return!!~n&&avalon.Array.removeAt(e,n)}}});var D=avalon.bindingHandlers={},P=avalon.bindingExecutors={};var F=new function(){function e(e){this.size=0,this.limit=e,this.head=this.tail=void 0,this._keymap={}}var t=e.prototype;return t.put=function(e,t){var n={key:e,value:t};return this._keymap[e]=n,this.tail?(this.tail.newer=n).older=this.tail:this.head=n,this.tail=n,this.size===this.limit?this.shift():this.size++,t},t.shift=function(){var e=this.head;e&&(this.head=this.head.newer,this.head.older=e.newer=e.older=this._keymap[e.key]=void 0)},t.get=function(e){var t=this._keymap[e];if(void 0!==t)return t===this.tail?t.value:(t.newer&&(t===this.head&&(this.head=t.newer),t.newer.older=t.older),t.older&&(t.older.newer=t.newer),t.newer=void 0,t.older=this.tail,this.tail&&(this.tail.newer=t),(this.tail=t).value)},e};if(!"司徒正美".trim){var I=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;String.prototype.trim=function(){return this.replace(I,"")}}var B=!{toString:null}.propertyIsEnumerable("toString"),V=function(){}.propertyIsEnumerable("prototype"),R=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],z=R.length;function W(e,t,n){var r="for(var "+e+"i=0,n = this.length; i < n; i++){"+t.replace("_","((i in this) && fn.call(scope,this[i],i,this))")+"}"+n;return Function("fn,scope",r)}function X(e,t){try{for(;t=t.parentNode;)if(t===e)return!0;return!1}catch(e){return!1}}function Y(){return(new XMLSerializer).serializeToString(this)}if(Object.keys||(Object.keys=function(e){var t=[],n=V&&"function"==typeof e;if("string"==typeof e||e&&e.callee)for(var r=0;r<e.length;++r)t.push(String(r));else for(var a in e)n&&"prototype"===a||!c.call(e,a)||t.push(String(a));if(B)for(var i=e.constructor,o=i&&i.prototype===e,l=0;l<z;l++){var s=R[l];o&&"constructor"===s||!c.call(e,s)||t.push(s)}return t}),Array.isArray||(Array.isArray=function(e){return"[object Array]"===l.call(e)}),M.bind||(Function.prototype.bind=function(n){if(arguments.length<2&&void 0===n)return this;var r=this,a=arguments;return function(){var e,t=[];for(e=1;e<a.length;e++)t.push(a[e]);for(e=0;e<arguments.length;e++)t.push(arguments[e]);return r.apply(n,t)}}),n.test([].map)||avalon.mix(v,{indexOf:function(e,t){var n=this.length,r=~~t;for(r<0&&(r+=n);r<n;r++)if(this[r]===e)return r;return-1},lastIndexOf:function(e,t){var n=this.length,r=null==t?n-1:t;for(r<0&&(r=Math.max(0,n+r));0<=r;r--)if(this[r]===e)return r;return-1},forEach:W("","_",""),filter:W("r=[],j=0,","if(_)r[j++]=this[i]","return r"),map:W("r=[],","r[i]=_","return r"),some:W("","if(_)return true","return false"),every:W("","if(!_)return false","return true")}),avalon.contains=X,$.contains||($.contains=function(e){return X($,e)}),w.SVGElement){$.createTextNode("x").contains||(Node.prototype.contains=function(e){return!!(16&this.compareDocumentPosition(e))});var q="http://www.w3.org/2000/svg",G=$.createElementNS(q,"svg");if(G.innerHTML='<circle cx="50" cy="50" r="40" fill="red" />',!T.test(G.firstChild)){function U(e,t){if(e&&e.childNodes)for(var n,r=e.childNodes,a=0;n=r[a++];)if(n.tagName){var i=$.createElementNS(q,n.tagName.toLowerCase());v.forEach.call(n.attributes,function(e){i.setAttribute(e.name,e.value)}),U(n,i),t.appendChild(i)}}Object.defineProperties(SVGElement.prototype,{outerHTML:{enumerable:!0,configurable:!0,get:Y,set:function(e){var t=this.tagName.toLowerCase(),n=this.parentNode,r=avalon.parseHTML(e);if("svg"===t)n.insertBefore(r,this);else{var a=$.createDocumentFragment();U(r,a),n.insertBefore(a,this)}n.removeChild(this)}},innerHTML:{enumerable:!0,configurable:!0,get:function(){var e=this.outerHTML,t=new RegExp("<"+this.nodeName+'\\b(?:(["\'])[^"]*?(\\1)|[^>])*>',"i"),n=new RegExp("</"+this.nodeName+">$","i");return e.replace(t,"").replace(n,"")},set:function(e){avalon.clearHTML&&(avalon.clearHTML(this),U(avalon.parseHTML(e),this))}}})}}!E.outerHTML&&w.HTMLElement&&HTMLElement.prototype.__defineGetter__("outerHTML",Y);var J=/^(?:mouse|contextmenu|drag)|click/;var Z=avalon.eventHooks;if("onmouseenter"in E||avalon.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,e){Z[a]={type:e,deel:function(n,e,r){return function(e){var t=e.relatedTarget;if(!t||t!==n&&!(16&n.compareDocumentPosition(t)))return delete e.type,e.type=a,r.call(n,e)}}}}),avalon.each({AnimationEvent:"animationend",WebKitAnimationEvent:"webkitAnimationEnd"},function(e,t){w[e]&&!Z.animationend&&(Z.animationend={type:t})}),"oninput"in $.createElement("input")||(Z.input={type:"propertychange",deel:function(t,e,n){return function(e){if("value"===e.propertyName)return e.type="input",n.call(t,e)}}}),void 0===$.onmousewheel){var K=void 0!==$.onwheel?"wheel":"DOMMouseScroll",Q="wheel"==K?"deltaY":"detail";Z.mousewheel={type:K,deel:function(t,e,n){return function(e){e.wheelDeltaY=e.wheelDelta=0<e[Q]?-120:120,e.wheelDeltaX=0,Object.defineProperty&&Object.defineProperty(e,"type",{value:"mousewheel"}),n.call(t,e)}}}}function ee(e){for(var t in e)if(c.call(e,t)){var n=e[t];"function"==typeof ee.plugins[t]?ee.plugins[t](n):"object"==typeof ee[t]?avalon.mix(ee[t],n):ee[t]=n}return this}var te,ne,re,ae,ie,oe=/[-.*+?^${}()|[\]\/\\]/g;function le(e){return(e+"").replace(oe,"\\$&")}var se={loader:function(e){w.require=r,w.define=a},interpolate:function(e){if(te=e[0],ne=e[1],te===ne)throw new SyntaxError("openTag!==closeTag");if(e+""=="\x3c!--,--\x3e")ee.commentInterpolate=!0;else{var t=te+"test"+ne;if(p.innerHTML=t,p.innerHTML!==t&&-1<p.innerHTML.indexOf("&lt;"))throw new SyntaxError("此定界符不合法");p.innerHTML=""}var n=le(te),r=le(ne);re=new RegExp(n+"(.*?)"+r),ae=new RegExp(n+"(.*?)"+r,"g"),ie=new RegExp(n+".*?"+r+"|\\sms-")}};ee.debug=!0,(ee.plugins=se).interpolate(["{{","}}"]),ee.paths={},ee.shim={},ee.maxRepeatSize=100,avalon.config=ee;var ce=/(\w+)\[(avalonctrl)="(\S+)"\]/,ue=$.querySelectorAll?function(e){return $.querySelectorAll(e)}:function(e){for(var t,n=e.match(ce),r=$.getElementsByTagName(n[1]),a=[],i=0;t=r[i++];)t.getAttribute(n[2])===n[3]&&a.push(t);return a},fe={$watch:function(e,t){if("function"==typeof t){var n=this.$events[e];n?n.push(t):this.$events[e]=[t]}else this.$events=this.$watch.backup;return this},$unwatch:function(e,t){var n=arguments.length;if(0===n)this.$watch.backup=this.$events,this.$events={};else if(1===n)this.$events[e]=[];else for(var r=this.$events[e]||[],a=r.length;~--a<0;)if(r[a]===t)return r.splice(a,1);return this},$fire:function(e){var n,t,r,a;/^(\w+)!(\S+)$/.test(e)&&(n=RegExp.$1,e=RegExp.$2);var i=this.$events;if(i){var o=x.call(arguments,1),l=[e].concat(o);if("all"===n)for(t in avalon.vmodels)(r=avalon.vmodels[t])!==this&&r.$fire.apply(r,l);else if("up"===n||"down"===n){var s=i.expr?ue(i.expr):[];if(0===s.length)return;for(t in avalon.vmodels)if((r=avalon.vmodels[t])!==this&&r.$events.expr){var c=ue(r.$events.expr);if(0===c.length)continue;v.forEach.call(c,function(t){v.forEach.call(s,function(e){("down"===n?e.contains(t):t.contains(e))&&(t._avalon=r)})})}var u=$.getElementsByTagName("*"),f=[];for(v.forEach.call(u,function(e){e._avalon&&(f.push(e._avalon),e._avalon="",e.removeAttribute("_avalon"))}),"up"===n&&f.reverse(),t=0;(a=f[t++])&&!1!==a.$fire.apply(a,l););}else{var p=i[e]||[],d=i.$all||[];for(t=0;a=p[t++];)S(a)&&a.apply(this,o);for(t=0;a=d[t++];)S(a)&&a.apply(this,arguments)}}}},pe=avalon.vmodels={};avalon.define=function(e,t){var n=e.$id||e;if(n||y("warning: vm必须指定$id"),pe[n]&&y("warning: "+n+" 已经存在于avalon.vmodels中"),"object"==typeof e)var r=ge(e);else{var a={$watch:M};t(a),r=ge(a),m=!0,t(r),m=!1}return r.$id=n,pe[n]=r};var de=String("$id,$watch,$unwatch,$fire,$events,$model,$skipArray,$proxy,$reinitialize").match(h),ve=Object.defineProperty,he=!0;try{ve({},"_",{value:"x"});var me=Object.defineProperties}catch(e){he=!1}function ge(t,e,a){if(Array.isArray(t)){var n=t.concat();t.length=0;var r=function(e){var n=[];for(var t in n.$id=k(),n.$model=e,n.$events={},n.$events[b]=[],n._=ge({length:e.length}),n._.$watch("length",function(e,t){n.$fire("length",e,t)}),fe)n[t]=fe[t];return avalon.mix(n,Se),n}(t);return r.pushArray(n),r}if(!t||0<t.nodeType||t.$id&&t.$events)return t;var i=Array.isArray(t.$skipArray)?t.$skipArray:[];i.$special=e||{};var o={};a=a||{};var l={},s={},c=[];for(var u in de.forEach(function(e){delete t[e]}),t)!function(e,t,n){if(Ee(e,a[e]=t,i)){l[e]=[];var r=avalon.type(t);"object"===r&&S(t.get)&&Object.keys(t).length<=2?(n=xe(e,t),c.push(n)):n=d.test(r)?we(e,t,r,l[e]):be(e,t),s[e]=n}}(u,t[u]);for(var f in o=me(o,ke(s),t),t)s[f]||(o[f]=t[f]);for(u in o.$id=k(),o.$model=a,o.$events=l,fe){var p=fe[u];_||(p=p.bind(o)),o[u]=p}return he?Object.defineProperty(o,"hasOwnProperty",ye):o.hasOwnProperty=function(e){return e in o.$model},o.$reinitialize=function(){c.forEach(function(r){delete r._value,delete r.oldArgs,r.digest=function(){r.call(o)},De.begin({callback:function(e,t){var n=t._name;t!==r&&Fe(e.$events[n],r.digest)}});try{r.get.call(o)}finally{De.end()}})},o.$reinitialize(),o}var ye={value:function(e){return e in this.$model},writable:!1,enumerable:!1,configurable:!0};function be(e,t){function n(e){var t=n._value;return 0<arguments.length?(m||_e(e,t)||(n.updateValue(this,e),n.notify(this,e,t)),this):(De.collectDependency(this,n),t)}return Te(n,e),n._value=t,n}function xe(i,e){function o(e){var t=o._value,n="_value"in o;if(0<arguments.length){if(m)return this;if("function"==typeof o.set&&o.oldArgs!==e){o.oldArgs=e;var r=this.$events,a=r[i];r[i]=[],o.set.call(this,e),r[i]=a,(e=o.get.call(this))!==t&&(o.updateValue(this,e),o.notify(this,e,t))}return this}return e=o.get.call(this),o.updateValue(this,e),n&&t!==e&&o.notify(this,e,t),e}return o.set=e.set,o.get=e.get,Te(o,i),o}function we(d,e,v,t){function h(e){var t=h._value,n=h._vmodel;if(0<arguments.length){if(m)return this;if("array"===v){var r=n,a=e,i=r.length,o=a.length;r.$lock=!0,o<i?r.splice(o,i-o):i<o&&r.push.apply(r,a.slice(i));for(var l=Math.min(i,o),s=0;s<l;s++)r.set(s,a[s]);delete r.$lock,r._fire("set")}else if("object"===v){var c=n.$proxy,u=(n=h._vmodel=ge(e)).$events[b]=this.$events[d]||[],f=u.concat();for(u.length=0,n.$proxy=c;r=f.shift();){var p=D[r.type];p&&(r.rollback&&r.rollback(),p(r,r.vmodels))}}return h.updateValue(this,n.$model),h.notify(this,this._value,t),this}return De.collectDependency(this,h),n}return Te(h,d),(h._vmodel=ge(e)).$events[b]=t,h}function $e(e,t){e.$model[this._name]=this._value=t}function Ce(e,t,n){var r=this._name,a=e.$events[r];a&&(Ie(a),fe.$fire.call(e,r,t,n))}function Te(e,t){e._name=t,e.updateValue=$e,e.notify=Ce}var _e=Object.is||function(e,t){return 0===e&&0===t?1/e==1/t:e!=e?t!=t:e===t};function Ee(e,t,n){if(S(t)||t&&t.nodeType)return!1;if(-1!==n.indexOf(e))return!1;var r=n.$special;return!(e&&"$"===e.charAt(0)&&!r[e])}var ke=_?function(e){var t={};for(var n in e)t[n]={get:e[n],set:e[n],enumerable:!0,configurable:!0};return t}:function(e){return e};if(!he&&("__defineGetter__"in avalon&&(ve=function(e,t,n){return"value"in n&&(e[t]=n.value),"get"in n&&e.__defineGetter__(t,n.get),"set"in n&&e.__defineSetter__(t,n.set),e},me=function(e,t){for(var n in t)t.hasOwnProperty(n)&&ve(e,n,t[n]);return e}),O)){var Ae={};function Me(e,t,n,r){var a=t[n];if(4!==arguments.length)return a.call(e);a.call(e,r)}w.execScript(["Function parseVB(code)","\tExecuteGlobal(code)","End Function"].join("\n"),"VBScript"),me=function(e,t,n){var r=[];for(e in r.push("\r\n\tPrivate [__data__], [__proxy__]","\tPublic Default Function [__const__](d, p)","\t\tSet [__data__] = d: set [__proxy__] = p","\t\tSet [__const__] = Me","\tEnd Function"),n)t.hasOwnProperty(e)||r.push("\tPublic ["+e+"]");for(e in de.forEach(function(e){t.hasOwnProperty(e)||r.push("\tPublic ["+e+"]")}),r.push("\tPublic [hasOwnProperty]"),t)r.push("\tPublic Property Let ["+e+"](val"+g+")",'\t\tCall [__proxy__](Me,[__data__], "'+e+'", val'+g+")","\tEnd Property","\tPublic Property Set ["+e+"](val"+g+")",'\t\tCall [__proxy__](Me,[__data__], "'+e+'", val'+g+")","\tEnd Property","\tPublic Property Get ["+e+"]","\tOn Error Resume Next","\t\tSet["+e+'] = [__proxy__](Me,[__data__],"'+e+'")',"\tIf Err.Number <> 0 Then","\t\t["+e+'] = [__proxy__](Me,[__data__],"'+e+'")',"\tEnd If","\tOn Error Goto 0","\tEnd Property");r.push("End Class");var a=r.join("\r\n"),i=Ae[a];return i||(i=k("VBClass"),w.parseVB("Class "+i+a),w.parseVB(["Function "+i+"Factory(a, b)","\tDim o","\tSet o = (New "+i+")(a, b)","\tSet "+i+"Factory = o","End Function"].join("\r\n")),Ae[a]=i),w[i+"Factory"](t,Me)}}function Oe(e,t,n,r,a,i,o){for(var l=this.length,s=2;--s;){switch(e){case"add":var c=this.$model.slice(t,t+n).map(function(e){return d.test(avalon.type(e))?e.$id?e:ge(e,0,e):e});Ne.apply(this,[t,0].concat(c)),this._fire("add",t,n);break;case"del":var u=this._splice(t,n);this._fire("del",t,n)}a&&(e=a,t=i,n=o,s=2,a=0)}return this._fire("index",r),this.length!==l&&(this._.length=this.length),u}var Ne=v.splice,Se={_splice:Ne,_fire:function(e,t,n){Ie(this.$events[b],e,t,n)},size:function(){return this._.length},pushArray:function(e){var t=e.length,n=this.length;return t&&(v.push.apply(this.$model,e),Oe.call(this,"add",n,t,Math.max(0,n-1))),t+n},push:function(){var e,t=[],n=arguments.length;for(e=0;e<n;e++)t[e]=arguments[e];return this.pushArray(t)},unshift:function(){var e=arguments.length,t=this.length;return e&&(v.unshift.apply(this.$model,arguments),Oe.call(this,"add",0,e,0)),e+t},shift:function(){if(this.length){var e=this.$model.shift();return Oe.call(this,"del",0,1,0),e}},pop:function(){var e=this.length;if(e){var t=this.$model.pop();return Oe.call(this,"del",e-1,1,Math.max(0,e-2)),t}},splice:function(e){var t,n=arguments.length,r=[],a=Ne.apply(this.$model,arguments);return a.length&&(r.push("del",e,a.length,0),t=!0),2<n&&(t?r.splice(3,1,0,"add",e,n-2):r.push("add",e,n-2,0),t=!0),t?Oe.apply(this,r):[]},contains:function(e){return-1!==this.indexOf(e)},remove:function(e){return this.removeAt(this.indexOf(e))},removeAt:function(e){return 0<=e?(this.$model.splice(e,1),Oe.call(this,"del",e,1,0)):[]},clear:function(){return this.$model.length=this.length=this._.length=0,this._fire("clear",0),this},removeAll:function(e){if(Array.isArray(e))for(var t=this.length-1;0<=t;t--)-1!==e.indexOf(this[t])&&this.removeAt(t);else if("function"==typeof e)for(t=this.length-1;0<=t;t--){e(this[t],t)&&this.removeAt(t)}else this.clear()},ensure:function(e){return this.contains(e)||this.push(e),this},set:function(e,t){if(0<=e){var n=avalon.type(t);t&&t.$model&&(t=t.$model);var r=this[e];if("object"===n)for(var a in t)r.hasOwnProperty(a)&&(r[a]=t[a]);else"array"===n?r.clear().push.apply(r,t):r!==t&&(this[e]=t,this.$model[e]=t,this._fire("set",e,t))}return this}};function Le(e,t){for(var n={},r=0,a=t.length;r<a;r++){n[r]=e[r];var i=t[r];i in n?(e[r]=n[i],delete n[i]):e[r]=e[i]}}"sort,reverse".replace(h,function(u){Se[u]=function(){var e,t=this.$model,n=t.concat(),r=Math.random(),a=[];v[u].apply(t,arguments);for(var i=0,o=n.length;i<o;i++){var l=t[i],s=n[i];if(_e(l,s))a.push(i);else{var c=n.indexOf(l);a.push(c),n[c]=r,e=!0}}return e&&(Le(this,a),this._fire("move",a),this._fire("index",0)),this}});var je,He,De=(He=[],{begin:function(e){He.push(je),je=e},end:function(){je=He.pop()},collectDependency:function(e,t){je&&je.callback(e,t)}}),Pe=/^(duplex|on)$/;function Fe(e,t){t=t||s[g],e&&t&&avalon.Array.ensure(e,t)&&t.element&&Ye(t,e)}function Ie(e){if(e&&e.length){444<new Date-Re&&"object"==typeof e[0]&&qe();for(var t,n=x.call(arguments,1),r=e.length;t=e[--r];){var a=t.element;if(a&&a.parentNode)try{if(t.$repeat)t.handler.apply(t,n);else if("on"!==t.type){var i=t.evaluator||M;t.handler(i.apply(0,t.args||[]),a,t)}}catch(e){}}}}avalon.injectBinding=function(n){var e=n.evaluator;if(e){De.begin({callback:function(e,t){Fe(e.$events[t._name],n)}});try{var t=Pe.test(n.type)?n:e.apply(0,n.args);n.handler(t,n.element,n)}catch(e){delete n.evaluator;var r=n.element;if(3===r.nodeType){var a=r.parentNode;ee.commentInterpolate?a.replaceChild($.createComment(n.value),r):r.data=te+n.value+ne}}finally{De.end()}}};var Be=0,Ve=avalon.$$subscribers=[],Re=new Date,ze={},We={};function Xe(e,t){return e.uuid||t||(e.uuid=++Be,We[e.uuid]=e),e.uuid}function Ye(e,t){var n=e.element;e.uuid||(1!==n.nodeType?e.uuid=e.type+(e.pos||0)+"-"+Xe(n.parentNode):e.uuid=e.name+"-"+Xe(n));var r=e.lists||(e.lists=[]);avalon.Array.ensure(r,t),t.$uuid=t.$uuid||k(),Ve[e.uuid]||(Ve[e.uuid]=1,Ve.push(e))}function qe(e){if(!avalon.optimize){for(var t=Ve.length,n=t,r=[],a={},i={};e=Ve[--t];){var o=e.type;i[o]?i[o]++:(i[o]=1,r.push(o))}var l=!1;if(r.forEach(function(e){ze[e]!==i[e]&&(a[e]=1,l=!0)}),t=n,l)for(;e=Ve[--t];)if(e.element&&a[e.type]&&Ue(e.element)){Ve.splice(t,1),delete Ve[e.uuid],delete We[e.element.uuid];for(var s,c=e.lists,u=0;s=c[u++];)avalon.Array.remove(c,s),avalon.Array.remove(s,e);Ge(e)}ze=i,Re=new Date}}function Ge(e){for(var t in e.element=null,e.rollback&&e.rollback(),e)e[t]=null}function Ue(e){try{if(!e.parentNode)return!0}catch(e){return!0}return e.msRetain?0:1===e.nodeType?!E.contains(e):!avalon.contains(E,e)}var Je={area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],col:[2,"<table><colgroup>","</colgroup></table>"],legend:[1,"<fieldset>","</fieldset>"],option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],tr:[2,"<table>","</table>"],td:[3,"<table><tr>","</tr></table>"],g:[1,'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1">',"</svg>"],_default:_?[0,"",""]:[1,"X<div>","</div>"]};Je.th=Je.td,Je.optgroup=Je.option,Je.tbody=Je.tfoot=Je.colgroup=Je.caption=Je.thead,String("circle,defs,ellipse,images,line,path,polygon,polyline,rect,symbol,text,use").replace(h,function(e){Je[e]=Je.g});var Ze=/<([\w:]+)/,Ke=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Qe=_?/[^\d\D]/:/(<(?:script|link|style|meta|noscript))/gi,et=f(["","text/javascript","text/ecmascript","application/ecmascript","application/javascript"]),tt=/<(?:tb|td|tf|th|tr|col|opt|leg|cap|area)/,nt=$.createElement("script"),rt=/<|&#?\w+;/;function at(e){var t=e.nodeName;return t.toLowerCase()===t&&e.scopeName&&""===e.outerText}function it(e){"url(#default#VML)"!==e.currentStyle.behavior&&(e.style.behavior="url(#default#VML)",e.style.display="inline-block",e.style.zoom=1)}function ot(e){return e.replace(/([a-z\d])([A-Z]+)/g,"$1-$2").toLowerCase()}function lt(e){return!e||e.indexOf("-")<0&&e.indexOf("_")<0?e:e.replace(/[-_][^-_]/g,function(e){return e.charAt(1).toUpperCase()})}avalon.parseHTML=function(e){var t=A.cloneNode(!1);if("string"!=typeof e)return t;if(!rt.test(e))return t.appendChild($.createTextNode(e)),t;e=e.replace(Ke,"<$1></$2>").trim();var n,r,a=(Ze.exec(e)||["",""])[1].toLowerCase(),i=Je[a]||Je._default,o=p;_||(e=e.replace(Qe,"<br class=msNoScope>$1")),o.innerHTML=i[1]+e+i[2];var l=o.getElementsByTagName("script");if(l.length)for(var s,c=0;s=l[c++];)et[s.type]&&(r=nt.cloneNode(!1),v.forEach.call(s.attributes,function(e){e&&e.specified&&(r[e.name]=e.value,r.setAttribute(e.name,e.value))}),r.text=s.text,s.parentNode.replaceChild(r,s));if(!_){var u="X<div>"===i[1]?o.lastChild.firstChild:o.lastChild;if(u&&"TABLE"===u.tagName&&"tbody"!==a)for(l=u.childNodes,c=0;s=l[c++];)if("TBODY"===s.tagName&&!s.innerHTML){u.removeChild(s);break}for(var f=(l=o.getElementsByTagName("br")).length;s=l[--f];)"msNoScope"===s.className&&s.parentNode.removeChild(s);for(l=o.all,c=0;s=l[c++];)at(s)&&it(s)}for(c=i[0];c--;o=o.lastChild);for(;n=o.firstChild;)t.appendChild(n);return t},avalon.innerHTML=function(e,t){if(!_&&!Qe.test(t)&&!tt.test(t))try{return void(e.innerHTML=t)}catch(e){}var n=this.parseHTML(t);this.clearHTML(e).appendChild(n)},avalon.clearHTML=function(e){for(e.textContent="";e.firstChild;)e.removeChild(e.firstChild);return e};var st={_toString:function(){var e=this.node.className;return("string"==typeof e?e:e.baseVal).split(/\s+/).join(" ")},_contains:function(e){return-1<(" "+this+" ").indexOf(" "+e+" ")},_add:function(e){this.contains(e)||this._set(this+" "+e)},_remove:function(e){this._set((" "+this+" ").replace(" "+e+" "," "))},__set:function(e){e=e.trim();var t=this.node;T.test(t)?t.setAttribute("class",e):t.className=e}};function ct(e){if(!("classList"in e))for(var t in e.classList={node:e},st)e.classList[t.slice(1)]=st[t];return e.classList}function ut(e){try{if("object"==typeof e)return e;e="true"===e||"false"!==e&&("null"===e?null:+e+""===e?+e:ft.test(e)?avalon.parseJSON(e):e)}catch(e){}return e}"add,remove".replace(h,function(n){avalon.fn[n+"Class"]=function(e){var t=this[0];return e&&"string"==typeof e&&t&&1===t.nodeType&&e.replace(/\S+/g,function(e){ct(t)[n](e)}),this}}),avalon.fn.mix({hasClass:function(e){var t=this[0]||{};return 1===t.nodeType&&ct(t).contains(e)},toggleClass:function(e,t){for(var n,r=0,a=String(e).split(/\s+/),i="boolean"==typeof t;n=a[r++];){var o=i?t:!this.hasClass(n);this[o?"addClass":"removeClass"](n)}return this},attr:function(e,t){return 2===arguments.length?(this[0].setAttribute(e,t),this):this[0].getAttribute(e)},data:function(t,e){switch(t="data-"+ot(t||""),arguments.length){case 2:return this.attr(t,e),this;case 1:return ut(this.attr(t));case 0:var n={};return v.forEach.call(this[0].attributes,function(e){e&&((t=e.name).indexOf("data-")||(t=lt(t.slice(5)),n[t]=ut(e.value)))}),n}},removeData:function(e){return e="data-"+ot(e),this[0].removeAttribute(e),this},css:function(e,t){if(avalon.isPlainObject(e))for(var n in e)avalon.css(this,n,e[n]);else var r=avalon.css(this,e,t);return void 0!==r?r:this},position:function(){var e,t,n=this[0],r={top:0,left:0};if(n)return"fixed"===this.css("position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),"HTML"!==e[0].tagName&&(r=e.offset()),r.top+=avalon.css(e[0],"borderTopWidth",!0),r.left+=avalon.css(e[0],"borderLeftWidth",!0),r.top-=e.scrollTop(),r.left-=e.scrollLeft()),{top:t.top-r.top-avalon.css(n,"marginTop",!0),left:t.left-r.left-avalon.css(n,"marginLeft",!0)}},offsetParent:function(){for(var e=this[0].offsetParent;e&&"static"===avalon.css(e,"position");)e=e.offsetParent;return avalon(e||E)},bind:function(e,t,n){if(this[0])return avalon.bind(this[0],e,t,n)},unbind:function(e,t,n){return this[0]&&avalon.unbind(this[0],e,t,n),this},val:function(e){var t=this[0];if(t&&1===t.nodeType){var n=0===arguments.length,r=n?":get":":set",a=kt[function(e){var t=e.tagName.toLowerCase();return"input"===t&&/checkbox|radio/.test(e.type)?"checked":t}(t)+r];if(a)var i=a(t,e);else{if(n)return(t.value||"").replace(/\r/g,"");t.value=e}}return n?i:this}});var ft=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,pt=/^[\],:{}\s]*$/,dt=/(?:^|:|,)(?:\s*\[)+/g,vt=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,ht=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g;avalon.parseJSON=w.JSON?JSON.parse:function(e){if("string"==typeof e){if((e=e.trim())&&pt.test(e.replace(vt,"@").replace(ht,"]").replace(dt,"")))return new Function("return "+e)();avalon.error("Invalid JSON: "+e)}return e},avalon.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,i){avalon.fn[a]=function(e){var t=this[0]||{},n=function(e){return e.window&&e.document?e:9===e.nodeType&&(e.defaultView||e.parentWindow)}(t),r="scrollTop"===a;if(!arguments.length)return n?i in n?n[i]:E[a]:t[a];n?n.scrollTo(r?avalon(n).scrollLeft():e,r?e:avalon(n).scrollTop()):t[a]=e}});var mt=avalon.cssHooks={},gt=["","-webkit-","-o-","-moz-","-ms-"],yt={float:_?"cssFloat":"styleFloat"};if(avalon.cssNumber=f("columnCount,order,fillOpacity,fontWeight,lineHeight,opacity,orphans,widows,zIndex,zoom"),avalon.cssName=function(e,t,n){if(yt[e])return yt[e];t=t||E.style;for(var r=0,a=gt.length;r<a;r++)if((n=lt(gt[r]+e))in t)return yt[e]=n;return null},mt["@:set"]=function(e,t,n){try{e.style[t]=n}catch(e){}},w.getComputedStyle)mt["@:get"]=function(e,t){if(!e||!e.style)throw new Error("getComputedStyle要求传入一个节点 "+e);var n,r=getComputedStyle(e,null);return r&&""===(n="filter"===t?r.getPropertyValue(t):r[t])&&(n=e.style[t]),n},mt["opacity:get"]=function(e){var t=mt["@:get"](e,"opacity");return""===t?"1":t};else{var bt=/^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i,xt=/^(top|right|bottom|left)$/,wt=/alpha\([^)]*\)/i,$t=!!w.XDomainRequest,Ct={thin:$t?"1px":"2px",medium:$t?"3px":"4px",thick:$t?"5px":"6px"};mt["@:get"]=function(e,t){var n=e.currentStyle,r=n[t];if(bt.test(r)&&!xt.test(r)){var a=e.style,i=a.left,o=e.runtimeStyle.left;e.runtimeStyle.left=n.left,a.left="fontSize"===t?"1em":r||0,r=a.pixelLeft+"px",a.left=i,e.runtimeStyle.left=o}return"medium"===r&&"none"===n[t=t.replace("Width","Style")]&&(r="0px"),""===r?"auto":Ct[r]||r},mt["opacity:set"]=function(e,t,n){var r=e.style,a=isFinite(n)&&n<=1?"alpha(opacity="+100*n+")":"",i=r.filter||"";r.zoom=1,r.filter=(wt.test(i)?i.replace(wt,a):i+" "+a).trim(),r.filter||r.removeAttribute("filter")},mt["opacity:get"]=function(e){var t=e.filters.alpha||e.filters["DXImageTransform.Microsoft.Alpha"];return(t&&t.enabled?t.opacity:100)/100+""}}"top,left".replace(h,function(n){mt[n+":get"]=function(e){var t=mt["@:get"](e,n);return/px$/.test(t)?t:avalon(e).position()[n]+"px"}});var Tt={position:"absolute",visibility:"hidden",display:"block"},_t=/^(none|table(?!-c[ea]).+)/;"Width,Height".replace(h,function(i){var o=i.toLowerCase(),r="client"+i,a="scroll"+i,l="offset"+i;mt[o+":get"]=function(e,t,n){var r=-4;"number"==typeof n&&(r=n),t="Width"===i?["Left","Right"]:["Top","Bottom"];var a=e[l];return 2===r?a+avalon.css(e,"margin"+t[0],!0)+avalon.css(e,"margin"+t[1],!0):(r<0&&(a=a-avalon.css(e,"border"+t[0]+"Width",!0)-avalon.css(e,"border"+t[1]+"Width",!0)),-4===r&&(a=a-avalon.css(e,"padding"+t[0],!0)-avalon.css(e,"padding"+t[1],!0)),a)},mt[o+"&get"]=function(e){var t=[];!function e(t,n){if(t.offsetWidth<=0){if(_t.test(mt["@:get"](t,"display"))){var r={node:t};for(var a in Tt)r[a]=t.style[a],t.style[a]=Tt[a];n.push(r)}var i=t.parentNode;i&&1===i.nodeType&&e(i,n)}}(e,t);for(var n,r=mt[o+":get"](e),a=0;n=t[a++];)for(var i in e=n.node,n)"string"==typeof n[i]&&(e.style[i]=n[i]);return r},avalon.fn[o]=function(e){var t=this[0];if(0!==arguments.length)return this.css(o,e);if(t.setTimeout)return t["inner"+i]||t.document.documentElement[r];if(9!==t.nodeType)return mt[o+"&get"](t);var n=t.documentElement;return Math.max(t.body[a],n[a],t.body[l],n[l],n[r])},avalon.fn["inner"+i]=function(){return mt[o+":get"](this[0],void 0,-2)},avalon.fn["outer"+i]=function(e){return mt[o+":get"](this[0],void 0,!0===e?2:0)}}),avalon.fn.offset=function(){var e=this[0],t={left:0,top:0};if(!e||!e.tagName||!e.ownerDocument)return t;var n=e.ownerDocument,r=n.body,a=n.documentElement,i=n.defaultView||n.parentWindow;if(!avalon.contains(a,e))return t;e.getBoundingClientRect&&(t=e.getBoundingClientRect());var o=a.clientTop||r.clientTop,l=a.clientLeft||r.clientLeft,s=Math.max(i.pageYOffset||0,a.scrollTop,r.scrollTop),c=Math.max(i.pageXOffset||0,a.scrollLeft,r.scrollLeft);return{top:t.top+s-o,left:t.left+c-l}};var Et=/^<option(?:\s+\w+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s>]+))?)*\s+value[\s=]/i,kt={"option:get":O?function(e){return Et.test(e.outerHTML)?e.value:e.text.trim()}:function(e){return e.value},"select:get":function(e,t){for(var n,r=e.options,a=e.selectedIndex,i=kt["option:get"],o="select-one"===e.type||a<0,l=o?null:[],s=o?a+1:r.length,c=a<0?s:o?a:0;c<s;c++)if(((n=r[c]).selected||c===a)&&!n.disabled){if(t=i(n),o)return t;l.push(t)}return l},"select:set":function(e,t,n){t=[].concat(t);for(var r,a=kt["option:get"],i=0;r=e.options[i++];)(r.selected=-1<t.indexOf(a(r)))&&(n=!0);n||(e.selectedIndex=-1)}},At={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},Mt=w.JSON&&JSON.stringify||function(e){return'"'+e.replace(/[\\\"\x00-\x1f]/g,function(e){var t=At[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"'},Ot=["break,case,catch,continue,debugger,default,delete,do,else,false","finally,for,function,if,in,instanceof,new,null,return,switch,this","throw,true,try,typeof,var,void,while,with","abstract,boolean,byte,char,class,const,double,enum,export,extends","final,float,goto,implements,import,int,interface,long,native","package,private,protected,template,short,static,super,synchronized","throws,transient,volatile","arguments,let,yield,undefined"].join(","),Nt=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|[\s\t\n]*\.[\s\t\n]*[$\w\.]+/g,St=/[^\w$]+/g,Lt=new RegExp(["\\b"+Ot.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g"),jt=/\b\d[^,]*/g,Ht=/^,+|,+$/g,Dt=new F(512),Pt=function(e){var t=","+e.trim(),n=Dt.get(t);if(n)return n;var r=e.replace(Nt,"").replace(St,",").replace(Lt,"").replace(jt,"").replace(Ht,"").split(/^$|,+/);return Dt.put(t,It(r))};function Ft(e,t,n,r){for(var a,i=[],o=" = "+n+".",l=e.length;a=e[--l];)t.hasOwnProperty(a)&&(i.push(a+o+a),r.vars.push(a),"duplex"===r.type&&(e.get=n+"."+a),e.splice(l,1));return i}function It(e){for(var t=[],n={},r=0;r<e.length;r++){var a=e[r],i=a&&"string"==typeof a.$id?a.$id:a;n[i]||(n[i]=t.push(a))}return t}var Bt=new F(128),Vt=/\w\[.*\]|\w\.\w/,Rt=/(\$proxy\$[a-z]+)\d+$/,zt=/\)\s*$/,Wt=/\)\s*\|/g,Xt=/\|\s*([$\w]+)/g,Yt=/"\s*\["/g,qt=/"\s*\(/g;function Gt(s,e,t){var n=t.type,r=t.filters||"",a=e.map(function(e){return String(e.$id).replace(Rt,"$1")})+s+n+r,i=Pt(s).concat(),c=[],o=[],l=[],u="";e=It(e),t.vars=[];for(var f=0,p=e.length;f<p;f++)if(i.length){var d="vm"+g+"_"+f;o.push(d),l.push(e[f]),c.push.apply(c,Ft(i,e[f],d,t))}if(c.length||"duplex"!==n){"duplex"!==n&&(-1<s.indexOf("||")||-1<s.indexOf("&&"))&&t.vars.forEach(function(l){var e=new RegExp("\\b"+l+"(?:\\.\\w+|\\[\\w+\\])+","ig");s=s.replace(e,function(e){var t=e.charAt(l.length),n=O?s.slice(arguments[1]+e.length):RegExp.rightContext,r=/^\s*\(/.test(n);if("."===t||"["===t||r){var a="var"+String(Math.random()).replace(/^0\./,"");if(r){var i=e.split(".");if(2<i.length){var o=i.pop();return c.push(a+" = "+i.join(".")),a+"."+o}return e}return c.push(a+" = "+e),a}return e})}),t.args=l,delete t.vars;var v=Bt.get(a);if(v)t.evaluator=v;else{if(u=(u=c.join(", "))&&"var "+u,/\S/.test(r)){if(!/text|html/.test(t.type))throw Error("ms-"+t.type+"不支持过滤器");s="\nvar ret"+g+" = "+s+";\r\n",s+=function(e,t){return"return avalon.filters.$filter("+e+", "+(t=t.replace(zt,"").replace(Wt,function(){return"],|"}).replace(Xt,function(e,t){return"["+Mt(t)}).replace(Yt,function(){return'"],["'}).replace(qt,function(){return'",'})+"]")+")"}("ret"+g,r)}else{if("duplex"===n){var h="'use strict';\nreturn function(vvv){\n\t"+u+";\n\tif(!arguments.length){\n\t\treturn "+s+"\n\t}\n\t"+(Vt.test(s)?s:i.get)+"= vvv;\n} ";try{v=Function.apply(M,o.concat(h)),t.evaluator=Bt.put(a,v)}catch(e){y("debug: parse error,"+e.message)}return}if("on"===n){-1===s.indexOf("(")?s+=".call(this, $event)":s=s.replace("(",".call(this,"),o.push("$event");var m=(s="\nreturn "+s+";").lastIndexOf("\nreturn");s=s.slice(0,m)+"\n"+s.slice(m)}else s="\nreturn "+s+";"}try{v=Function.apply(M,o.concat("'use strict';\n"+u+s)),t.evaluator=Bt.put(a,v)}catch(e){y("debug: parse error,"+e.message)}finally{i=c=o=null}}}}function Ut(e,t,n,r,a){Array.isArray(r)&&(e=r.map(function(e){return e.expr?"("+e.value+")":Mt(e.value)}).join(" + ")),Gt(e,t,n),n.evaluator&&!a&&(n.handler=P[n.handlerName||n.type],avalon.injectBinding(n))}avalon.parseExprProxy=Ut,avalon.scan=function(e,t){yn(e=e||E,t?[].concat(t):[])};var Jt=f("area,base,basefont,br,col,command,embed,hr,img,input,link,meta,param,source,track,wbr,noscript,script,style,textarea".toUpperCase());function Zt(e,t){var n=e.getAttribute("avalonctrl")||t.$id;e.setAttribute("avalonctrl",n),t.$events.expr=e.tagName+'[avalonctrl="'+n+'"]'}function Kt(e,t,n){var r=e.getAttribute(t);if(r)for(var a,i=0;a=n[i++];)if(a.hasOwnProperty(r)&&"function"==typeof a[r])return a[r]}function Qt(e,t){for(var n,r=0;n=e[r++];)n.vmodels=t,D[n.type](n,t),n.evaluator&&n.element&&1===n.element.nodeType&&n.element.removeAttribute(n.name);e.length=0}var en=O&&w.MutationObserver?function(e){for(var t,n=e.firstChild;n;){var r=n.nextSibling;3===n.nodeType?t?(t.nodeValue+=n.nodeValue,e.removeChild(n)):t=n:t=null,n=r}}:0,tn=/ms-(\w+)-?(.*)/,nn={if:10,repeat:90,data:100,widget:110,each:1400,with:1500,duplex:2e3,on:3e3},rn=f("animationend,blur,change,input,click,dblclick,focus,keydown,keypress,keyup,mousedown,mouseenter,mouseleave,mousemove,mouseout,mouseover,mouseup,scan,scroll,submit"),an=f("value,title,alt,checked,selected,disabled,readonly,enabled");function on(e,t){return e.priority-t.priority}function ln(t,e,n){var r=!0;if(e.length){for(var a,i=hn?hn(t):t.attributes,o=[],l=[],s={},c=0;a=i[c++];)if(a.specified&&(n=a.name.match(tn))){var u=n[1],f=n[2]||"",p=a.value,d=a.name;if(rn[u]?(f=u,u="on"):an[u]&&("enabled"===u&&(y("warning!ms-enabled或ms-attr-enabled已经被废弃"),u="disabled",p="!("+p+")"),f=u,d="ms-"+(u="attr")+"-"+f,l.push([a.name,d,p])),s[d]=p,"function"==typeof D[u]){var v={type:u,param:f,element:t,name:d,value:p,priority:(nn[u]||10*u.charCodeAt(0))+(Number(f.replace(/\D/g,""))||0)};if("html"===u||"text"===u){var h=Tn(p);avalon.mix(v,h),v.filters=v.filters.replace(bn,function(){return v.type="html",v.group=1,""})}else if("duplex"===u)var m=d;else"ms-if-loop"===d&&(v.priority+=100);o.push(v),"widget"===u&&(t.msData=t.msData||s)}}if(o.length){for(o.sort(on),l.forEach(function(e){y("warning!请改用"+e[1]+"代替"+e[0]+"!"),t.removeAttribute(e[0]),t.setAttribute(e[1],e[2])}),m&&(s["ms-attr-checked"]&&y("warning!一个控件不能同时定义ms-attr-checked与"+m),s["ms-attr-value"]&&y("warning!一个控件不能同时定义ms-attr-value与"+m)),c=0;v=o[c];c++){if(u=v.type,sn.test(u))return Qt(o.slice(0,c+1),e);r=r&&!cn.test(u)}Qt(o,e)}}r&&!Jt[t.tagName]&&ie.test(t.innerHTML.replace(wn,"<").replace($n,">"))&&(en&&en(t),function(e,t){mn(avalon.slice(e.childNodes),t)}(t,e))}var sn=/^if|widget|repeat$/,cn=/^each|with|html|include$/;if(!"1"[0])var un=new F(512),fn=/\s+(ms-[^=\s]+)(?:=("[^"]*"|'[^']*'|[^\s>]+))?/g,pn=/^['"]/,dn=/<\w+\b(?:(["'])[^"]*?(\1)|[^>])*>/i,vn=/&amp;/g,hn=function(e){var t=e.outerHTML;if("</"===t.slice(0,2)||!t.trim())return[];var n,r,a=t.match(dn)[0],i=[],o=un.get(a);if(o)return o;for(;n=fn.exec(a);){r=(r=n[2])&&(pn.test(r)?r.slice(1,-1):r).replace(vn,"&");var l=n[1].toLowerCase();l.match(tn);var s={name:l,specified:!0,value:r||""};i.push(s)}return un.put(a,i)};function mn(e,t){for(var n,r=0;n=e[r++];)gn(n,n.nodeType,t)}function gn(e,t,n){1===t?(yn(e,n),e.msCallback&&(e.msCallback(),e.msCallback=void 0)):3===t&&re.test(e.data)?En(e,n):ee.commentInterpolate&&8===t&&!re.test(e.nodeValue)&&En(e,n)}function yn(e,t,n){var r=e.getAttribute("ms-skip");if(!e.getAttributeNode)return y("warning "+e.tagName+" no getAttributeNode method");var a=e.getAttributeNode("ms-important"),i=e.getAttributeNode("ms-controller");if("string"!=typeof r){if(n=a||i){var o=avalon.vmodels[n.value];if(!o)return;t=n===a?[o]:[o].concat(t);var l=n.name;e.removeAttribute(l),avalon(e).removeClass(l),Zt(e,o)}ln(e,t)}}var bn=/\|\s*html\s*/,xn=/\|\|/g,wn=/&lt;/g,$n=/&gt;/g,Cn=/(['"])(\\\1|.)+?\1/g;function Tn(e,t){if(0<e.indexOf("|")){var n=e.replace(Cn,function(e){return Array(e.length+1).join("1")}).replace(xn,"ᄢ㍄").indexOf("|");if(-1<n)return{filters:e.slice(n),value:e.slice(0,n),pos:t||0,expr:!0}}return{value:e,filters:"",expr:!0}}function _n(e){for(var t,n,r=[],a=0;;){if(-1===(n=e.indexOf(te,a)))break;if((t=e.slice(a,n))&&r.push({value:t,filters:"",expr:!1}),a=n+te.length,-1===(n=e.indexOf(ne,a)))break;(t=e.slice(a,n))&&r.push(Tn(t,a)),a=n+ne.length}return(t=e.slice(a))&&r.push({value:t,expr:!1,filters:""}),r}function En(e,t){var n=[];if(8===e.nodeType)var r=Tn(e.nodeValue),a=[r];else a=_n(e.data);if(a.length){for(var i=0;r=a[i++];){var o=$.createTextNode(r.value);r.expr&&(r.type="text",r.element=o,r.filters=r.filters.replace(bn,function(){return r.type="html",""}),n.push(r)),A.appendChild(o)}e.parentNode.replaceChild(A,e),n.length&&Qt(n,t)}}var kn=["autofocus,autoplay,async,allowTransparency,checked,controls","declare,disabled,defer,defaultChecked,defaultSelected","contentEditable,isMap,loop,multiple,noHref,noResize,noShade","open,readOnly,selected"].join(","),An={};kn.replace(h,function(e){An[e.toLowerCase()]=e});var Mn={"accept-charset":"acceptCharset",char:"ch",charoff:"chOff",class:"className",for:"htmlFor","http-equiv":"httpEquiv"};["accessKey,bgColor,cellPadding,cellSpacing,codeBase,codeType,colSpan","dateTime,defaultValue,frameBorder,longDesc,maxLength,marginWidth,marginHeight","rowSpan,tabIndex,useMap,vSpace,valueType,vAlign"].join(",").replace(h,function(e){Mn[e.toLowerCase()]=e});function On(){return new(w.XMLHttpRequest||ActiveXObject)("Microsoft.XMLHTTP")}var Nn=/<noscript.*?>(?:[\s\S]+?)<\/noscript>/gim,Sn=/<noscript.*?>([\s\S]+?)<\/noscript>/im,Ln=avalon.templateCache={};D.attr=function(e,t){var n=e.value.trim(),r=!0;if(-1<n.indexOf(te)&&2<n.indexOf(ne)&&(r=!1,re.test(n)&&""===RegExp.rightContext&&""===RegExp.leftContext&&(r=!0,n=RegExp.$1)),"include"===e.type){var a=e.element;e.includeRendered=Kt(a,"data-include-rendered",t),e.includeLoaded=Kt(a,"data-include-loaded",t);var i=e.includeReplace=!!avalon(a).data("includeReplace");avalon(a).data("includeCache")&&(e.templateCache={}),e.startInclude=$.createComment("ms-include"),e.endInclude=$.createComment("ms-include-end"),i?(e.element=e.startInclude,a.parentNode.insertBefore(e.startInclude,a),a.parentNode.insertBefore(e.endInclude,a.nextSibling)):(a.insertBefore(e.startInclude,a.firstChild),a.appendChild(e.endInclude))}e.handlerName="attr",Ut(n,t,e,r?0:_n(e.value))},P.attr=function(l,e,s){var t=s.type,n=s.param;if("css"===t)avalon(e).css(n,l);else if("attr"===t){var r=!1===l||null==l;!_&&Mn[n]&&(n=Mn[n]);var a=An[n];if("boolean"==typeof e[a]&&(e[a]=!!l,l||(r=!0)),r)return e.removeAttribute(n);!T.test(e)&&(!(!$.namespaces||!at(e))||n in e.cloneNode(!1))?e[n]=l+"":e.setAttribute(n,l)}else if("include"===t&&l){function i(e){if(f){var t=f.apply(p,[e].concat(c));"string"==typeof t&&(e=t)}u&&!function t(n,r,a){var i=setTimeout(function(){var e=n.innerHTML;clearTimeout(i),e===a?r():t(n,r,e)})}(p,function(){u.call(p)},NaN);var n=s.includeLastID;if(s.templateCache&&n&&n!==l){var r=s.templateCache[n];r||(r=s.templateCache[n]=$.createElement("div"),C.appendChild(r))}for(s.includeLastID=l;;){var a=s.startInclude.nextSibling;if(!a||a===s.endInclude)break;p.removeChild(a),r&&r.appendChild(a)}var i=function(e,t,n){var r=e.templateCache&&e.templateCache[t];if(r){for(var a,i=$.createDocumentFragment();a=r.firstChild;)i.appendChild(a);return i}return avalon.parseHTML(n)}(s,l,e),o=avalon.slice(i.childNodes);p.insertBefore(i,s.endInclude),mn(o,c)}var c=s.vmodels,u=s.includeRendered,f=s.includeLoaded,p=s.includeReplace?e.parentNode:e;if("src"===s.param)if("string"==typeof Ln[l])avalon.nextTick(function(){i(Ln[l])});else if(Array.isArray(Ln[l]))Ln[l].push(i);else{var o=On();o.onreadystatechange=function(){if(4===o.readyState){var e=o.status;if(200<=e&&e<300||304===e||1223===e){for(var t,n=o.responseText,r=0;t=Ln[l][r++];)t(n);Ln[l]=n}}},Ln[l]=[i],o.open("GET",l,!0),"withCredentials"in o&&(o.withCredentials=!0),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.send(null)}else{var d=l&&1===l.nodeType?l:$.getElementById(l);if(d){if("NOSCRIPT"===d.tagName&&!d.innerHTML&&!d.fixIE78){(o=On()).open("GET",location,!1),o.send(null);for(var v=$.getElementsByTagName("noscript"),h=(o.responseText||"").match(Nn)||[],m=h.length,g=0;g<m;g++){var y=v[g];y&&(y.style.display="none",y.fixIE78=(h[g].match(Sn)||["","&nbsp;"])[1])}}avalon.nextTick(function(){i(d.fixIE78||d.value||d.innerText||d.innerHTML)})}}}else if(E.hasAttribute||"string"!=typeof l||"src"!==t&&"href"!==t||(l=l.replace(/&amp;/g,"&")),e[t]=l,w.chrome&&"EMBED"===e.tagName){var b=e.parentNode,x=document.createComment("ms-src");b.replaceChild(x,e),b.replaceChild(e,x)}},"title,alt,src,value,css,include,href".replace(h,function(e){D[e]=D.attr}),D.class=function(e,t){var n,r=e.param,a=e.value;if(e.handlerName="class",!r||isFinite(r)){e.param="";var i=a.replace(ae,function(e){return e.replace(/./g,"0")}).indexOf(":");if(-1===i)var o=a;else{if(o=a.slice(0,i),Gt(n=a.slice(i+1),t,e),!e.evaluator)return y("debug: ms-class '"+(n||"").trim()+"' 不存在于VM中"),!1;e._evaluator=e.evaluator,e._args=e.args}var l=re.test(o);l||(e.immobileClass=o),Ut("",t,e,l?_n(o):0)}else e.immobileClass=e.oldStyle=e.param,Ut(a,t,e)},P.class=function(e,t,n){var r=avalon(t),a=n.type;if("class"===a&&n.oldStyle)r.toggleClass(n.oldStyle,!!e);else switch(n.toggleClass=!n._evaluator||!!n._evaluator.apply(t,n._args),n.newClass=n.immobileClass||e,n.oldClass&&n.newClass!==n.oldClass&&r.removeClass(n.oldClass),n.oldClass=n.newClass,a){case"class":r.toggleClass(n.newClass,n.toggleClass);break;case"hover":case"active":if(!n.hasBindEvent){var i="mouseenter",o="mouseleave";if("active"===a){t.tabIndex=t.tabIndex||-1,i="mousedown",o="mouseup";var l=r.bind("mouseleave",function(){n.toggleClass&&r.removeClass(n.newClass)})}var s=r.bind(i,function(){n.toggleClass&&r.addClass(n.newClass)}),c=r.bind(o,function(){n.toggleClass&&r.removeClass(n.newClass)});n.rollback=function(){r.unbind("mouseleave",l),r.unbind(i,s),r.unbind(o,c)},n.hasBindEvent=!0}}},"hover,active".replace(h,function(e){D[e]=D.class}),P.data=function(e,t,n){var r="data-"+n.param;e&&"object"==typeof e?t[r]=e:t.setAttribute(r,String(e))};var jn=D.duplex=function(r,e){var t,a=r.element;if(Ut(r.value,e,r,0,1),r.changed=Kt(a,"data-duplex-changed",e)||M,r.evaluator&&r.args){var n=[],i=f("string,number,boolean,checked");for(var o in"radio"===a.type&&""===r.param&&(r.param="checked"),a.msData&&(a.msData["ms-duplex"]=r.value),r.param.replace(/\w+/g,function(e){/^(checkbox|radio)$/.test(a.type)&&/^(radio|checked)$/.test(e)&&("radio"===e&&y("ms-duplex-radio已经更名为ms-duplex-checked"),e="checked",r.isChecked=!0),"bool"===e?(e="boolean",y("ms-duplex-bool已经更名为ms-duplex-boolean")):"text"===e&&(e="string",y("ms-duplex-text已经更名为ms-duplex-string")),i[e]&&(t=!0),avalon.Array.ensure(n,e)}),t||n.push("string"),r.param=n.join("-"),r.bound=function(e,t){a.addEventListener?a.addEventListener(e,t,!1):a.attachEvent("on"+e,t);var n=r.rollback;r.rollback=function(){a.avalonSetter=null,avalon.unbind(a,e,t),n&&n()}},avalon.vmodels){avalon.vmodels[o].$fire("avalon-ms-duplex-init",r)}(r.pipe||(r.pipe=Dn))(null,r,"init");var l=a.tagName;jn[l]&&jn[l](a,r.evaluator.apply(null,r.args),r)}};function Hn(e){return null==e?"":e}function Dn(n,r,a,e){return r.param.replace(/\w+/g,function(e){var t=avalon.duplexHooks[e];t&&"function"==typeof t[a]&&(n=t[a](n,r))}),n}avalon.duplexHooks={checked:{get:function(e,t){return!t.element.oldValue}},string:{get:function(e){return e},set:Hn},boolean:{get:function(e){return"true"===e},set:Hn},number:{get:function(e,t){var n=parseFloat(e);if(-e==-n)return n;switch((/strong|medium|weak/.exec(t.element.getAttribute("data-duplex-number"))||["medium"])[0]){case"strong":return 0;case"medium":return""===e?"":0;case"weak":return e}},set:Hn}};var Pn,Fn=[];function In(){for(var e=Fn.length-1;0<=e;e--){!1===(0,Fn[e])()&&Fn.splice(e,1)}Fn.length||clearInterval(Pn)}avalon.tick=function(e){1===Fn.push(e)&&(Pn=setInterval(In,60))};var Bn=M,Vn=/text|password|hidden/;new function(){try{var t={},e=HTMLInputElement.prototype,n=HTMLTextAreaElement.prototype;function r(e){t[this.tagName].call(this,e),Vn.test(this.type)&&!this.msFocus&&this.avalonSetter&&this.avalonSetter()}var a=HTMLInputElement.prototype;Object.getOwnPropertyNames(a),t.INPUT=Object.getOwnPropertyDescriptor(e,"value").set,Object.defineProperty(e,"value",{set:r}),t.TEXTAREA=Object.getOwnPropertyDescriptor(n,"value").set,Object.defineProperty(n,"value",{set:r})}catch(e){Bn=avalon.tick}},O&&avalon.bind($,"selectionchange",function(e){var t=$.activeElement;t&&"function"==typeof t.avalonSetter&&t.avalonSetter()}),jn.INPUT=function(r,a,i){var e=r.type,t=i.bound,o=avalon(r),n=!1;function l(e){i.changed.call(this,e,i)}function s(){n=!0}function c(){n=!1}var u=function(){if(!n){var e=r.oldValue=r.value,t=i.pipe(e,i,"get");!1!==o.data("duplexObserve")&&(a(t),l.call(r,t),o.data("duplex-focus")&&avalon.nextTick(function(){r.focus()}))}};if(i.handler=function(){var e=i.pipe(a(),i,"set")+"";e!==r.oldValue&&(r.value=e)},i.isChecked||"radio"===e){var f=6===O;u=function(){if(!1!==o.data("duplexObserve")){var e=i.pipe(r.value,i,"get");a(e),l.call(r,e)}},i.handler=function(){var e=a(),t=i.isChecked?!!e:e+""===r.value;r.oldValue=t,f?setTimeout(function(){r.defaultChecked=t,r.checked=t},31):r.checked=t},t("click",u)}else if("checkbox"===e)u=function(){if(!1!==o.data("duplexObserve")){var e=r.checked?"ensure":"remove",t=a();Array.isArray(t)||(y("ms-duplex应用于checkbox上要对应一个数组"),t=[t]);var n=i.pipe(r.value,i,"get");avalon.Array[e](t,n),l.call(r,t)}},i.handler=function(){var e=[].concat(a()),t=i.pipe(r.value,i,"get");r.checked=-1<e.indexOf(t)},t(_?"change":"click",u);else{var p=r.getAttribute("data-duplex-event")||"input";function d(e){setTimeout(function(){u(e)})}r.attributes["data-event"]&&y("data-event指令已经废弃，请改用data-duplex-event"),p.replace(h,function(e){switch(e){case"input":O?(8<O?t("input",u):t("propertychange",function(e){"value"===e.propertyName&&u()}),t("dragend",d)):(t("input",u),t("compositionstart",s),t("compositionend",c),t("DOMAutoComplete",u));break;default:t(e,u)}}),t("focus",function(){r.msFocus=!0}),t("blur",function(){r.msFocus=!1}),Vn.test(e)&&Bn(function(){if(E.contains(r))r.msFocus||r.oldValue===r.value||u();else if(!r.msRetain)return!1}),r.avalonSetter=u}r.oldValue=r.value,avalon.injectBinding(i),l.call(r,r.value)},jn.TEXTAREA=jn.INPUT,jn.SELECT=function(t,n,r){var a=avalon(t);r.handler=function(){var e=n();e=e&&e.$model||e,Array.isArray(e)?t.multiple||y("ms-duplex在<select multiple=true>上要求对应一个数组"):t.multiple&&y("ms-duplex在<select multiple=false>不能对应一个数组"),(e=Array.isArray(e)?e.map(String):e+"")+""!==t.oldValue&&(a.val(e),t.oldValue=e+"")},r.bound("change",function(){if(!1!==a.data("duplexObserve")){var e=a.val();(e=Array.isArray(e)?e.map(function(e){return r.pipe(e,r,"get")}):r.pipe(e,r,"get"))+""!==t.oldValue&&n(e),r.changed.call(t,e,r)}}),t.msCallback=function(){avalon.injectBinding(r),r.changed.call(t,n(),r)}},P.html=function(e,t,n){var r=1!==t.nodeType,a=r?t.parentNode:t;if(a&&(e=null==e?"":e,n.oldText!==e)){if(n.oldText=e,3===t.nodeType){var i=k("html");a.insertBefore($.createComment(i),t),n.element=$.createComment(i+":end"),a.replaceChild(n.element,t),t=n.element}if("object"!=typeof e)var o=avalon.parseHTML(String(e));else if(11===e.nodeType)o=e;else if(1===e.nodeType||e.item){var l=1===e.nodeType?e.childNodes:e.item;for(o=A.cloneNode(!0);l[0];)o.appendChild(l[0])}if(l=avalon.slice(o.childNodes),r){for(var s=t.nodeValue.slice(0,-4);;){var c=t.previousSibling;if(!c||8===c.nodeType&&c.nodeValue===s)break;a.removeChild(c)}a.insertBefore(o,t)}else avalon.clearHTML(t).appendChild(o);mn(l,n.vmodels)}},D.if=D.data=D.text=D.html=function(e,t){Ut(e.value,t,e)},P.if=function(e,t,n){try{if(!t.parentNode)return}catch(e){return}if(e)8===t.nodeType&&(t.parentNode.replaceChild(n.template,t),t=n.element=n.template),t.getAttribute(n.name)&&(t.removeAttribute(n.name),ln(t,n.vmodels)),n.rollback=null;else if(1===t.nodeType){var r=n.element=$.createComment("ms-if");t.parentNode.replaceChild(r,t),n.template=t,C.appendChild(t),n.rollback=function(){t.parentNode===C&&C.removeChild(t)}}};var Rn=/\(([^)]*)\)/;function zn(e,t,n,r){var a=e.template.cloneNode(!0),i=avalon.slice(a.childNodes);e.$with||a.insertBefore($.createComment(e.signature),a.firstChild),t.appendChild(a);var o={nodes:i,vmodels:[n].concat(e.vmodels)};r.push(o)}function Wn(e,t,n){for(;;){var r=t.previousSibling;if(!r)break;if(r.parentNode.removeChild(r),n&&n.call(r),r===e)break}}D.on=function(e,t){var n=e.value;e.type="on";var r=e.param.replace(/-\d+$/,"");if("function"==typeof D.on[r+"Hook"]&&D.on[r+"Hook"](e),0<n.indexOf("(")&&-1<n.indexOf(")")){var a=(n.match(Rn)||["",""])[1].trim();""!==a&&"$event"!==a||(n=n.replace(Rn,""))}Ut(n,t,e)},P.on=function(e,t,n){e=function(e){return(n.evaluator||M).apply(this,n.args.concat(e))};var r=n.param.replace(/-\d+$/,"");if("scan"===r)e.call(t,{type:r});else if("function"==typeof n.specialBind)n.specialBind(t,e);else var a=avalon.bind(t,r,e);n.rollback=function(){"function"==typeof n.specialUnbind?n.specialUnbind():avalon.unbind(t,r,a)}},D.repeat=function(e,t){var n=e.type;Ut(e.value,t,e,0,1);var r=!(e.proxies=[]);try{var a=e.$repeat=e.evaluator.apply(0,e.args||[]),i=avalon.type(a);"object"!==i&&"array"!==i&&(r=!0,avalon.log("warning:"+e.value+"只能是对象或数组"))}catch(e){r=!0}var o=e.value.split(".")||[];if(1<o.length){o.pop();for(var l,s=o[0],c=0;l=t[c++];)if(l&&l.hasOwnProperty(s)){var u=l[s].$events||{};u[b]=u[b]||[],u[b].push(e);break}}var f=e.element;if(1===f.nodeType){f.removeAttribute(e.name),e.sortedCallback=Kt(f,"data-with-sorted",t),e.renderedCallback=Kt(f,"data-"+n+"-rendered",t);var p=k(n),d=$.createComment(p),v=$.createComment(p+":end");if(e.signature=p,e.template=A.cloneNode(!1),"repeat"===n){var h=f.parentNode;h.replaceChild(v,f),h.insertBefore(d,v),e.template.appendChild(f)}else{for(;f.firstChild;)e.template.appendChild(f.firstChild);f.appendChild(d),f.appendChild(v)}e.element=v,e.handler=P.repeat,e.rollback=function(){e.element&&e.handler("clear")}}if(!r){e.$outer={};var m="$key",g="$val";for(Array.isArray(a)&&(m="$first",g="$last"),c=0;l=t[c++];)if(l.hasOwnProperty(m)&&l.hasOwnProperty(g)){e.$outer=l;break}Fe((a.$events||{})[b],e),"object"===i?(e.$with=!0,a.$proxy||(a.$proxy={}),e.handler("append",a)):a.length&&e.handler("add",0,a.length)}},P.repeat=function(e,t,n){if(e){var r,a,i=this,o=i.element,l=function(e){var t=e.element,n=t.nodeValue.replace(":end",""),r=t.previousSibling,a=[];for(;r;)r.nodeValue===n&&a.unshift(r),r=r.previousSibling;return a}(i),s=o.parentNode,c=i.proxies,u=A.cloneNode(!1);switch(e){case"add":for(var f=t+n,p=[],d=t;d<f;d++){var v=Un(d,i);c.splice(d,0,v),zn(i,u,v,p)}var h=new Date-0;for(avalon.optimize=avalon.optimize||h,d=0;a=p[d++];)mn(a.nodes,a.vmodels),a.nodes=a.vmodels=null;avalon.optimize===h&&delete avalon.optimize,s.insertBefore(u,l[t]||o),avalon.profile("插入操作花费了 "+(new Date-h));break;case"del":Wn(l[t],l[t+n]||o),qn(c.splice(t,n));break;case"clear":(r=l[0])&&(Wn(r,o),i.$with&&s.insertBefore(r,o)),qn(c);break;case"move":if(r=l[0]){var m,g=r.nodeValue,y=[],b=[];for(Wn(r,o,function(){b.unshift(this),this.nodeValue===g&&(y.unshift(b),b=[])}),Le(y,t),Le(c,t);b=y.shift();)for(;m=b.shift();)u.appendChild(m);s.insertBefore(u,o)}break;case"index":for(var x=c.length-1;n=c[t];t++)n.$index=t,n.$first=0===t,n.$last=t===x;return;case"set":(v=c[t])&&Ie(v.$events[i.param||"el"]);break;case"append":var w=t,$=w.$proxy,C=[];for(var T in p=[],$)w.hasOwnProperty(T)||(Jn($[T],Xn),delete $[T]);for(T in w)w.hasOwnProperty(T)&&"hasOwnProperty"!==T&&"$proxy"!==T&&C.push(T);if(i.sortedCallback){var _=i.sortedCallback.call(s,C);_&&Array.isArray(_)&&_.length&&(C=_)}for(d=0;T=C[d++];)"hasOwnProperty"!==T&&($[T]=Yn($[T],T,i),zn(i,u,$[T],p));for(s.insertBefore(u,o),d=0;a=p[d++];)mn(a.nodes,a.vmodels),a.nodes=a.vmodels=null}if(!i.$repeat||i.$repeat.hasOwnProperty("$lock"))return;"clear"===e&&(e="del");var E=i.renderedCallback||M,k=arguments;s.oldValue&&"SELECT"===s.tagName&&avalon(s).val(s.oldValue.split(",")),E.apply(s,k)}},"with,each".replace(h,function(e){D[e]=D.repeat});var Xn=[];function Yn(e,t,n){(e=e||Xn.pop())?e.$reinitialize():e=function(){var e=ge({$key:"",$outer:{},$host:{},$val:{get:function(){return this.$host[this.$key]},set:function(e){this.$host[this.$key]=e}}},{$val:1});return e.$id=k("$proxy$with"),e}();var r=n.$repeat;return e.$key=t,e.$host=r,e.$outer=n.$outer,r.$events?e.$events.$val=r.$events[t]:e.$events={},e}function qn(e){!function(e){e.forEach(function(e){Jn(e,Gn)}),e.length=0}(e)}var Gn=[];function Un(e,t){for(var n,r=t.param||"el",a=0,i=Gn.length;a<i;a++){var o=Gn[a];o&&o.hasOwnProperty(r)&&(n=o,Gn.splice(a,1))}n=n||function(n){var e={$host:[],$outer:{},$index:0,$first:!1,$last:!1,$remove:avalon.noop};e[n]={get:function(){var e=this.$events,t=e.$index;e.$index=e[n];try{return this.$host[this.$index]}finally{e.$index=t}},set:function(e){try{var t=this.$events,n=t.$index;t.$index=[],this.$host.set(this.$index,e)}catch(t){t.$index=n}}};var t=ge(e,{$last:1,$first:1,$index:1});return t.$id=k("$proxy$each"),t}(r);var l=t.$repeat,s=l.length-1;return n.$index=e,n.$first=0===e,n.$last=e===s,n.$host=l,n.$outer=t.$outer,n.$remove=function(){return l.removeAt(n.$index)},n}function Jn(e,t){for(var n in e.$events)Array.isArray(e.$events[n])&&(e.$events[n].forEach(function(e){"object"==typeof e&&Ge(e)}),e.$events[n].length=0);e.$host=e.$outer={},t.unshift(e)>ee.maxRepeatSize&&t.pop()}function Zn(e,t){var n="_"+e;if(!Zn[n]){var r=$.createElement(e);E.appendChild(r),t=_?getComputedStyle(r,null).display:r.currentStyle.display,E.removeChild(r),Zn[n]=t}return Zn[n]}P.text=function(e,t){if(e=null==e?"":e,3===t.nodeType)try{t.data=e}catch(e){}else"textContent"in t?t.textContent=e:t.innerText=e},avalon.parseDisplay=Zn,D.visible=function(e,t){var n=avalon(e.element),r=n.css("display");if("none"===r){var a=n[0].style,i=/visibility/i.test(a.cssText),o=n.css("visibility");a.display="",a.visibility="hidden","none"===(r=n.css("display"))&&(r=Zn(n[0].nodeName)),a.visibility=i?o:""}e.display=r,Ut(e.value,t,e)},P.visible=function(e,t,n){t.style.display=e?n.display:"none"},D.widget=function(e,t){var n=e.value.match(h),r=e.element,a=n[0],i=n[1];i&&"$"!==i||(i=k(a));var o=n[2]||a,l=avalon.ui[a];if("function"==typeof l){t=r.vmodels||t;for(var s,c=0;s=t[c++];)if(s.hasOwnProperty(o)&&"object"==typeof s[o]){var u=s[o];u=u.$model||u;break}if(u){var f=u[a+"Id"];"string"==typeof f&&(y("warning!不再支持"+a+"Id"),i=f)}var p=avalon.getWidgetData(r,a);e.value=[a,i,o].join(","),e[a+"Id"]=i,e.evaluator=M,r.msData["ms-widget-id"]=i;var d=e[a+"Options"]=avalon.mix({},l.defaults,u||{},p);r.removeAttribute("ms-widget");var v=l(r,e,t)||{};if(v.$id){avalon.vmodels[i]=v,Zt(r,v);try{v.$init(function(){avalon.scan(r,[v].concat(t)),"function"==typeof d.onInit&&d.onInit.call(r,v,d,t)})}catch(e){}e.rollback=function(){try{v.widgetElement=null,v.$remove()}catch(e){}r.msData={},delete avalon.vmodels[v.$id]},Ye(e,Kn),w.chrome&&r.addEventListener("DOMNodeRemovedFromDocument",function(){setTimeout(qe)})}else avalon.scan(r,t)}else t.length&&(r.vmodels=t)};var Kn=[],Qn=/<script[^>]*>([\S\s]*?)<\/script\s*>/gim,er=/\s+(on[^=\s]+)(?:=("[^"]*"|'[^']*'|[^\s>]+))?/g,tr=/<\w+\b(?:(["'])[^"]*?(\1)|[^>])*>/gi,nr={a:/\b(href)\=("javascript[^"]*"|'javascript[^']*')/gi,img:/\b(src)\=("javascript[^"]*"|'javascript[^']*')/gi,form:/\b(action)\=("javascript[^"]*"|'javascript[^']*')/gi},rr=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,ar=/([^\#-~| |!])/g;function ir(e,t,n,r){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var a,i,o,l=isFinite(+e)?+e:0,s=isFinite(+t)?Math.abs(t):3,c=r||",",u=n||".",f="";return 3<(f=(s?(a=l,i=s,o=Math.pow(10,i),""+(Math.round(a*o)/o).toFixed(i)):""+Math.round(l)).split("."))[0].length&&(f[0]=f[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,c)),(f[1]||"").length<s&&(f[1]=f[1]||"",f[1]+=new Array(s-f[1].length+1).join("0")),f.join(u)}var or=avalon.filters={uppercase:function(e){return e.toUpperCase()},lowercase:function(e){return e.toLowerCase()},truncate:function(e,t,n){return t=t||30,n="string"==typeof n?n:"...",e.length>t?e.slice(0,t-n.length)+n:String(e)},$filter:function(e){for(var t=1,n=arguments.length;t<n;t++){var r=arguments[t],a=avalon.filters[r.shift()];if("function"==typeof a){var i=[e].concat(r);e=a.apply(null,i)}}return e},camelize:lt,sanitize:function(e){return e.replace(Qn,"").replace(tr,function(e,t){var n=e.toLowerCase().match(/<(\w+)\s/);if(n){var r=nr[n[1]];r&&(e=e.replace(r,function(e,t,n){var r=n.charAt(0);return t+"="+r+"javascript:;"+r}))}return e.replace(er," ").replace(/\s+/g," ")})},escape:function(e){return String(e).replace(/&/g,"&amp;").replace(rr,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(ar,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")},currency:function(e,t,n){return(t||"￥")+ir(e,isFinite(n)?n:2)},number:ir};new function(){function v(e){return parseInt(e,10)||0}function o(e,t,n){var r="";for(e<0&&(r="-",e=-e),e=""+e;e.length<t;)e="0"+e;return n&&(e=e.substr(e.length-t)),r+e}function e(n,r,a,i){return function(e){var t=e["get"+n]();return(0<a||-a<t)&&(t+=a),0===t&&-12===a&&(t=12),o(t,r,i)}}function t(r,a){return function(e,t){var n=e["get"+r]();return t[(a?"SHORT"+r:r).toUpperCase()][n]}}var h={yyyy:e("FullYear",4),yy:e("FullYear",2,0,!0),y:e("FullYear",1),MMMM:t("Month"),MMM:t("Month",!0),MM:e("Month",2,1),M:e("Month",1,1),dd:e("Date",2),d:e("Date",1),HH:e("Hours",2),H:e("Hours",1),hh:e("Hours",2,-12),h:e("Hours",1,-12),mm:e("Minutes",2),m:e("Minutes",1),ss:e("Seconds",2),s:e("Seconds",1),sss:e("Milliseconds",3),EEEE:t("Day"),EEE:t("Day",!0),a:function(e,t){return e.getHours()<12?t.AMPMS[0]:t.AMPMS[1]},Z:function(e){var t=-1*e.getTimezoneOffset(),n=0<=t?"+":"";return n+=o(Math[0<t?"floor":"ceil"](t/60),2)+o(Math.abs(t%60),2)}},m=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,g=/^\/Date\((\d+)\)\/$/;or.date=function(t,e){var n,r,a=or.date.locate,i="",o=[];if(e=a[e=e||"mediumDate"]||e,"string"==typeof t)if(/^\d+$/.test(t))t=v(t);else if(g.test(t))t=+RegExp.$1;else{var l=t.trim(),s=[0,0,0,0,0,0,0],c=new Date(0);l=l.replace(/^(\d+)\D(\d+)\D(\d+)/,function(e,t,n,r){var a=4===r.length?[r,t,n]:[t,n,r];return s[0]=v(a[0]),s[1]=v(a[1])-1,s[2]=v(a[2]),""});var u=c.setFullYear,f=c.setHours;l=l.replace(/[T\s](\d+):(\d+):?(\d+)?\.?(\d)?/,function(e,t,n,r,a){return s[3]=v(t),s[4]=v(n),s[5]=v(r),a&&(s[6]=Math.round(1e3*parseFloat("0."+a))),""});var p=0,d=0;l=l.replace(/Z|([+-])(\d\d):?(\d\d)/,function(e,t,n,r){return u=c.setUTCFullYear,f=c.setUTCHours,t&&(p=v(t+n),d=v(t+r)),""}),s[3]-=p,s[4]-=d,u.apply(c,s.slice(0,3)),f.apply(c,s.slice(3)),t=c}if("number"==typeof t&&(t=new Date(t)),"date"===avalon.type(t)){for(;e;)e=(r=m.exec(e))?(o=o.concat(r.slice(1))).pop():(o.push(e),null);return o.forEach(function(e){i+=(n=h[e])?n(t,a):e.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),i}};var n={AMPMS:{0:"上午",1:"下午"},DAY:{0:"星期日",1:"星期一",2:"星期二",3:"星期三",4:"星期四",5:"星期五",6:"星期六"},MONTH:{0:"1月",1:"2月",2:"3月",3:"4月",4:"5月",5:"6月",6:"7月",7:"8月",8:"9月",9:"10月",10:"11月",11:"12月"},SHORTDAY:{0:"周日",1:"周一",2:"周二",3:"周三",4:"周四",5:"周五",6:"周六"},fullDate:"y年M月d日EEEE",longDate:"y年M月d日",medium:"yyyy-M-d H:mm:ss",mediumDate:"yyyy-M-d",mediumTime:"H:mm:ss",short:"yy-M-d ah:mm",shortDate:"yy-M-d",shortTime:"ah:mm"};n.SHORTMONTH=n.MONTH,or.date.locate=n},new function(){avalon.config({loader:!1});var e,t=[],n="complete"===$.readyState;function r(e){for(n=1;e=t.shift();)e()}avalon.bind($,"DOMContentLoaded",e=function(){avalon.unbind($,"DOMContentLoaded",e),r()});var a=setInterval(function(){"complete"===document.readyState&&document.body&&(clearInterval(a),r())},50);avalon.ready=function(e){n?e(avalon):t.push(e)},avalon.ready(function(){avalon.scan($.body)})},"function"==typeof define&&define.amd&&define("avalon",[],function(){return avalon});var lr=w.avalon;return avalon.noConflict=function(e){return e&&w.avalon===avalon&&(w.avalon=lr),avalon},void 0===e&&(w.avalon=avalon),avalon});